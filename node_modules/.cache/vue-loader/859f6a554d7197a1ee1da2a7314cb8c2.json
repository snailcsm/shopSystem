{"remainingRequest":"F:\\学习资料\\vue\\电商系统\\wwwroot\\shop\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!F:\\学习资料\\vue\\电商系统\\wwwroot\\shop\\src\\views\\user\\User.vue?vue&type=style&index=0&id=46ee9385&scoped=true&lang=css&","dependencies":[{"path":"F:\\学习资料\\vue\\电商系统\\wwwroot\\shop\\src\\views\\user\\User.vue","mtime":1636359398843},{"path":"F:\\学习资料\\vue\\电商系统\\wwwroot\\shop\\node_modules\\css-loader\\dist\\cjs.js","mtime":1635841485143},{"path":"F:\\学习资料\\vue\\电商系统\\wwwroot\\shop\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":1635841509973},{"path":"F:\\学习资料\\vue\\电商系统\\wwwroot\\shop\\node_modules\\postcss-loader\\src\\index.js","mtime":1635841500549},{"path":"F:\\学习资料\\vue\\电商系统\\wwwroot\\shop\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1635841480656},{"path":"F:\\学习资料\\vue\\电商系统\\wwwroot\\shop\\node_modules\\vue-loader\\lib\\index.js","mtime":1635841509972}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoNCi51c2VyLWNvbnRhaW57DQogIGJhY2tncm91bmQ6ICMzNTNiNDc7DQogIG1hcmdpbi10b3A6MjBweDsNCiAgcGFkZGluZzogMjBweDsNCn0NCiAgLnVzZXItdGFibGV7DQogICAgYm9yZGVyLXJhZGl1czogNnB4Ow0KICAgIG92ZXJmbG93OiBoaWRkZW47DQogIH0NCi5lbC1pbnB1dC1ncm91cF9fYXBwZW5kIGJ1dHRvbi5lbC1idXR0b257DQogIGNvbG9yOiAjRkZGOw0KICBiYWNrZ3JvdW5kLWNvbG9yOiAjNDA5RUZGOw0KICBib3JkZXItY29sb3I6ICM0MDlFRkY7DQp9DQo="},{"version":3,"sources":["User.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAmYA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"User.vue","sourceRoot":"src/views/user","sourcesContent":["<template>\r\n   <div class=\"user\">\r\n     <el-breadcrumb separator-class=\"el-icon-arrow-right\">\r\n       <el-breadcrumb-item :to=\"{ path: '/' }\">首页</el-breadcrumb-item>\r\n       <el-breadcrumb-item>用户列表</el-breadcrumb-item>\r\n     </el-breadcrumb>\r\n     <div class=\"user-contain\">\r\n       <el-row :gutter=\"20\">\r\n         <el-col :span=\"6\"><div class=\"grid-content bg-purple\">\r\n           <el-input placeholder=\"请输入搜索内容\" v-model=\"infoKey\" clearable @clear=\"getData\">\r\n             <el-button  slot=\"append\" type=\"primary\" icon=\"el-icon-search\" @click=\"serchUser\"></el-button>\r\n           </el-input>\r\n         </div></el-col>\r\n         <el-col :span=\"4\"><div class=\"grid-content bg-purple\">\r\n           <el-button type=\"primary\" @click=\"openAddUserDialog\">添加用户</el-button>\r\n         </div></el-col>\r\n       </el-row>\r\n      <!--列表-->\r\n       <el-table\r\n         class=\"user-table\"\r\n         :data=\"userData\"\r\n         style=\"width: 100%\"\r\n         border\r\n       >\r\n         <el-table-column\r\n           label=\"序号\"\r\n           width=\"60\"\r\n           type=\"index\">\r\n         </el-table-column>\r\n         <el-table-column\r\n           prop=\"name\"\r\n           label=\"姓名\"\r\n           width=\"120\">\r\n         </el-table-column>\r\n         <el-table-column\r\n           prop=\"role\"\r\n           label=\"权限角色\"\r\n           width=\"180\">\r\n         </el-table-column>\r\n         <el-table-column\r\n           prop=\"mobile\"\r\n           label=\"联系方式\">\r\n         </el-table-column>\r\n         <el-table-column\r\n           prop=\"creattime\"\r\n           label=\"注册时间\">\r\n         </el-table-column>\r\n         <el-table-column\r\n           label=\"状态\">\r\n           <template slot-scope=\"scope\">\r\n             <el-switch\r\n               v-model=\"scope.row.state\"\r\n             @change=\"setState(scope.row.id)\"\r\n             >\r\n             </el-switch>\r\n           </template>\r\n         </el-table-column>\r\n         <el-table-column\r\n           label=\"操作\"\r\n           width=\"240\">\r\n           <template slot-scope=\"scope\">\r\n             <el-tooltip class=\"item\" effect=\"light\" content=\"修改用户信息\" placement=\"top\">\r\n             <el-button\r\n               type=\"primary\"\r\n               @click=\"handleEdit(scope.row)\"\r\n               icon=\"el-icon-edit\"></el-button></el-tooltip>\r\n             <el-tooltip class=\"item\" effect=\"light\" content=\"修改用户权限\" placement=\"top\">\r\n             <el-button\r\n               type=\"waring\"\r\n               icon=\"el-icon-setting\"\r\n               @click=\"handleRole(scope.row)\"></el-button></el-tooltip>\r\n             <el-tooltip class=\"item\" effect=\"light\" content=\"删除用户\" placement=\"top\">\r\n             <el-button\r\n               type=\"danger\"\r\n               icon=\"el-icon-delete\"\r\n               @click=\"handleDelete(scope.row)\"></el-button> </el-tooltip>\r\n           </template>\r\n         </el-table-column>\r\n       </el-table>\r\n\r\n       <!--分页-->\r\n       <el-pagination\r\n         class=\"user-pagination\"\r\n         @size-change=\"handleSizeChange\"\r\n         @current-change=\"handleCurrentChange\"\r\n         :current-page=\"currenPge\"\r\n         :page-sizes=\"[2, 4, 6, 8,10]\"\r\n         :page-size=\"pageSize\"\r\n         layout=\"total, sizes, prev, pager, next, jumper\"\r\n         :total=\"userCount\">\r\n       </el-pagination>\r\n\r\n\r\n     </div>\r\n\r\n     <!--添加用户对话框-->\r\n     <el-dialog title=\"添加新用户\" :visible.sync=\"addUserDialog\">\r\n       <el-form :model=\"newUser\" ref=\"addUserRef\" :rules=\"rules\">\r\n         <el-form-item label=\"姓名\" :label-width=\"formLabelWidth\" prop=\"name\">\r\n           <el-input v-model=\"newUser.name\" autocomplete=\"off\"></el-input>\r\n         </el-form-item>\r\n         <el-form-item label=\"电话\" :label-width=\"formLabelWidth\" prop=\"mobile\">\r\n           <el-input v-model=\"newUser.mobile\" autocomplete=\"off\"></el-input>\r\n         </el-form-item>\r\n         <el-form-item label=\"权限角色\" :label-width=\"formLabelWidth\" prop=\"role\">\r\n           <el-input v-model=\"newUser.role\" autocomplete=\"off\"></el-input>\r\n         </el-form-item>\r\n         <el-form-item label=\"密码\" :label-width=\"formLabelWidth\" prop=\"password\">\r\n           <el-input v-model=\"newUser.password\" type=\"password\"  autocomplete=\"off\"></el-input>\r\n         </el-form-item>\r\n       </el-form>\r\n       <div slot=\"footer\" class=\"dialog-footer\">\r\n         <el-button @click=\"closeAdd\">取 消</el-button>\r\n         <el-button type=\"primary\" @click=\"addUser\">确 定</el-button>\r\n       </div>\r\n     </el-dialog>\r\n\r\n     <!--修改信息对话框-->\r\n     <el-dialog title=\"修改用户信息\" :visible.sync=\"editUserDialog\">\r\n       <el-form :model=\"editUser\" ref=\"editUserRef\" :rules=\"rules\">\r\n         <el-form-item label=\"姓名\" :label-width=\"formLabelWidth\" prop=\"name\">\r\n           <el-input v-model=\"editUser.name\" autocomplete=\"off\"></el-input>\r\n         </el-form-item>\r\n         <el-form-item label=\"电话\" :label-width=\"formLabelWidth\" prop=\"mobile\">\r\n           <el-input v-model=\"editUser.mobile\" autocomplete=\"off\"></el-input>\r\n         </el-form-item>\r\n         <el-form-item label=\"权限角色\" :label-width=\"formLabelWidth\" prop=\"role\">\r\n           <el-input v-model=\"editUser.role\" autocomplete=\"off\"></el-input>\r\n         </el-form-item>\r\n         <el-form-item label=\"密码\" :label-width=\"formLabelWidth\" prop=\"password\">\r\n           <el-input v-model=\"editUser.password\" type=\"password\"  autocomplete=\"off\"></el-input>\r\n         </el-form-item>\r\n       </el-form>\r\n       <div slot=\"footer\" class=\"dialog-footer\">\r\n         <el-button @click=\"closeEdit\">取 消</el-button>\r\n         <el-button type=\"primary\" @click=\"editUserMsg\">确 定</el-button>\r\n       </div>\r\n     </el-dialog>\r\n\r\n     <!--删除对话框-->\r\n     <el-dialog\r\n       title=\"删除提示\"\r\n       :visible.sync=\"deleteDialog\"\r\n       width=\"30%\">\r\n       <span>{{deleteTips}}</span>\r\n       <span slot=\"footer\" class=\"dialog-footer\">\r\n    <el-button @click=\"closeDelete\">取 消</el-button>\r\n    <el-button type=\"primary\" @click=\"deleteUser\">确 定</el-button>\r\n  </span>\r\n     </el-dialog>\r\n     <!--<el-button @click=\"setState\">点击测试数据获取</el-button>-->\r\n   </div>\r\n</template>\r\n\r\n<script>\r\nimport {nanoid} from 'nanoid'\r\n    export default {\r\n        name: \"User\",\r\n      /*data(){\r\n          return{\r\n          userData:[{\r\n            id:'001',\r\n            name:'admin',\r\n            mobile:'13211766263',\r\n            role:'超级管理员',\r\n            creatTime:'2021-10-11 12:00',\r\n            state:true\r\n          },\r\n            {\r\n              id:'002',\r\n              name:'张三',\r\n              mobile:'13211765874',\r\n              role:'人事部管理员',\r\n              creatTime:'2021-07-11 21:00',\r\n              state:true\r\n            },\r\n            {\r\n              id:'003',\r\n              name:'小明',\r\n              mobile:'13211765874',\r\n              role:'事务部',\r\n              creatTime:'2021-07-11 19:00',\r\n              state:true\r\n            },\r\n            {\r\n              id:'004',\r\n              name:'小刘',\r\n              mobile:'13211765356',\r\n              role:'销售部',\r\n              creatTime:'2021-07-11 08:00',\r\n              state:false\r\n            }\r\n          ]\r\n        }\r\n      },*/\r\n      data(){\r\n        let mobileRule=(rule,value,callback)=>{\r\n            let rule1 = /^[1]+[3,4,5,6,7,8,9]+\\d{9}$/;\r\n            if(!rule1.test(value)){\r\n              return  callback(new Error(\"电话号码有误，请核对都重新输入\"));\r\n            }\r\n            callback();\r\n          }\r\n        return {\r\n          userData: [],\r\n          userCount: 0,\r\n          infoKey: '',\r\n          serverData: [],\r\n          pageSize: 4,\r\n          currenPge: 1,\r\n          newUser: {\r\n            id: '',\r\n            name: '',\r\n            role: '',\r\n            state: true,\r\n            mobile: '',\r\n            password: \"\",\r\n            creattime: ''\r\n          },\r\n          editUser:{},\r\n          addUserDialog: false,\r\n          editUserDialog:false,\r\n          deleteDialog:false,\r\n          formLabelWidth: '120px',\r\n          rules: {\r\n          name: [\r\n            {required: true, message: '请输入登录账号', trigger: 'blur'},\r\n            {min: 5, max: 10, message: '长度在 5 到 10个字符', trigger: 'blur'}],\r\n            password: [\r\n              {required: true, message: '请输入密码', trigger: 'blur'},\r\n              {min: 6, max: 15, message: '长度在 6 到 15 个字符', trigger: 'blur'}],\r\n            mobile:[\r\n              {required: true, message: '请输入电话号码', trigger: 'blur'},\r\n              {validator:mobileRule,trigger:'blur'}],\r\n            role:[\r\n              {required: true, message: '请输入角色权限', trigger: 'blur'}\r\n            ]\r\n\r\n        },\r\n          deleteTips:\"\",\r\n          deleteId:''\r\n        }\r\n      },\r\n      created() {\r\n      this.getData();\r\n      },\r\n      methods:{\r\n        getData(){//获取用户信息\r\n          this.$http.get('/user').then(res=>{\r\n            this.serverData=res.data;\r\n            this.userCount=res.data.length;\r\n            this.chanUserData();\r\n          })\r\n        },\r\n        /*更新表格源数据*/\r\n        chanUserData(){\r\n          let start=(this.currenPge-1)*this.pageSize;\r\n          let end=start+this.pageSize;\r\n          end=end>this.userCount?this.userCount:end;\r\n          this.userData=this.serverData.slice(start,end);\r\n          console.log(this.serverData)\r\n          console.log(this.userData);\r\n        },\r\n        /*更改用户状态*/\r\n        setState(id){\r\n          this.$http.post('/setState',{'id':id\r\n          },{\r\n            headers: {'Content-Type': 'application/x-www-form-urlencoded'} //加上这个\r\n          }).then(res=>{\r\n            console.log(res)\r\n          },\r\n          err=>{\r\n            console.log(err)\r\n          })\r\n        },\r\n        //修改页码\r\n        handleCurrentChange(value){\r\n          this.currenPge=value;\r\n          this.chanUserData();\r\n          console.log(\"当前页\"+value);\r\n        },\r\n        //修改当前页显示的数量\r\n        handleSizeChange(value){\r\n          this.pageSize=value;\r\n          this.chanUserData();\r\n        },\r\n        //搜索功能\r\n        serchUser(){\r\n          this.serverData=this.serverData.filter(item=>{\r\n              return item.name.indexOf(this.infoKey)>-1;\r\n          })\r\n          this.userCount=this.serverData.length;\r\n         this.chanUserData();\r\n        },\r\n        //打开添加用户对话框\r\n        openAddUserDialog(){\r\n          this.newUser.name=\"\";\r\n          this.newUser.role=\"\";\r\n          this.newUser.mobile=\"\";\r\n          this.newUser.password=\"\";\r\n          this.addUserDialog=true;\r\n        },\r\n        //添加用户\r\n        addUser(){\r\n          this.newUser.id=nanoid();\r\n          const myData=new Date();\r\n          this.newUser.creattime=myData.getFullYear()+\"-\"+myData.getMonth()+\"-\"+myData.getDay()+\" \"+myData.getHours()+\":\"+myData.getMinutes()\r\n          //执行axios post添加数据,没有借口，忽略，仅在本地操作数据\r\n\r\n          //校验数据\r\n            this.$refs.addUserRef.validate((value,obj)=>{\r\n                 if(value){\r\n                 this.serverData.unshift(this.newUser);\r\n                 this.chanUserData();\r\n                 this.$message.success('添加成功！');\r\n                 this.addUserDialog=false;\r\n                 this.userCount++;\r\n               }else{\r\n                return   this.$message.error(obj[Object.keys(obj)[0]][0].message);\r\n                }\r\n            })\r\n\r\n\r\n        },\r\n        //关闭添加用户对话框\r\n        closeAdd(){\r\n          this.$refs.addUserRef.resetFields();//清空表格内容\r\n          this.addUserDialog=false;\r\n        },\r\n        //点击修改用户\r\n        handleEdit(editObj){\r\n          this.editUser=editObj;\r\n          this.editUserDialog=true;\r\n          console.log(editObj)\r\n        },\r\n        //确定修改\r\n        editUserMsg(){\r\n          this.$refs.editUserRef.validate((value,obj)=>{\r\n            if(value){\r\n              this.serverData.filter(item=>{\r\n                if(item.id===this.editUser.id){\r\n                  item=this.editUser;\r\n                }\r\n              })\r\n\r\n              //this.chanUserData();\r\n              this.$message.success('修改成功！');\r\n              this.editUserDialog=false;\r\n            }else{\r\n              this.$message.error(obj[Object.keys(obj)[0]][0].message);\r\n            }\r\n          })\r\n        },\r\n        //关闭修改对话框\r\n        closeEdit(){\r\n          this.$refs.editUserRef.resetFields();//清空表格内容\r\n          this.editUserDialog=false;\r\n        },\r\n        //弹出删除对话框\r\n        handleDelete(obj){\r\n          this.deleteTips=\"确定删除\"+obj.name+\"吗？\"\r\n          this.deleteDialog=true;\r\n          this.deleteId=obj.id;\r\n        },\r\n        //关闭删除对话框\r\n        closeDelete(){\r\n          this.deleteDialog=false;\r\n          this.deleteTips=\"\";\r\n        },\r\n        //删除用户\r\n        deleteUser(){\r\n          this.serverData=this.serverData.filter(item=>{\r\n         return   item.id!==this.deleteId;\r\n          });\r\n          this.userCount--;\r\n          this.chanUserData();\r\n          this.deleteDialog=false;\r\n        },\r\n        //\r\n        handleRole(value){\r\n          this.$message.info(\"正在施工中~\")\r\n        }\r\n      }\r\n    }\r\n</script>\r\n\r\n<style scoped>\r\n.user-contain{\r\n  background: #353b47;\r\n  margin-top:20px;\r\n  padding: 20px;\r\n}\r\n  .user-table{\r\n    border-radius: 6px;\r\n    overflow: hidden;\r\n  }\r\n.el-input-group__append button.el-button{\r\n  color: #FFF;\r\n  background-color: #409EFF;\r\n  border-color: #409EFF;\r\n}\r\n</style>\r\n"]}]}